# [개인] ESG 데이터 기반 기업 주가 변동성 분석 및 예측 모델링

## 1. 프로젝트 제목
**ESG 데이터 기반 기업 주가 변동성 분석 및 예측 모델링**

## 2. 프로젝트 소개
본 프로젝트는 **기업별 ESG 등급 데이터와 주가 데이터를 수집·분석하여 ESG 경영 활동이 주가 안정성에 미치는 영향을 통계적으로 규명하고, 시계열 분석을 통해 향후 주가 변동성을 예측하는 데이터 분석 프로젝트**입니다. 한국거래소(KRX)의 ESG 데이터와 주식 시장 데이터를 결합하여 비재무적 성과가 기업의 재무적 리스크(변동성) 완화에 실제로 기여하는지를 분석하고, 이를 바탕으로 투자 위험을 예측하는 모델을 구현하였습니다.

## 3. 프로젝트 개요
- **진행 일정**: 2025.02.17 ~ 2025.03.07
- **참여 인원**: 2인
- **전체 구성**:
    - **Step 1. 데이터 수집**: Selenium을 이용한 KRX ESG 포털 크롤링 및 금융 데이터 확보.
    - **Step 2. 데이터 전처리**: 결측치 제거, 연도별 데이터 병합, 이상치 처리.
    - **Step 3. 통계 분석**: OLS 회귀분석을 통한 ESG 등급과 주가 변동성의 상관관계 도출.
    - **Step 4. 시계열 예측**: ARIMA 모델을 활용한 향후 ESG 우수/미흡 기업군의 변동성 예측.
- **주요 기능 요약**:
    - KRX ESG 등급 자동화 수집 크롤러.
    - 주가 수익률 표준편차(변동성) 계산 로직.
    - ESG 등급에 따른 변동성 차이 시각화 및 회귀 리포트 생성.
    - ARIMA 기반의 향후 3년(12분기) 주가 변동성 시계열 예측.
- **대상 사용자**:
    - ESG 투자 전략을 수립하고자 하는 기관 및 개인 투자자.
    - 기업의 비재무적 리스크를 정량적으로 평가하고 싶은 금융 분석가.

## 4. 프로젝트 배경
- **문제점**: 전통적인 재무 제표 분석만으로는 기후 변화, 사회적 책임 등 기업의 지속 가능성 리스크를 완전히 파악하기 어렵습니다.
- **기존 방식의 한계**: 단순히 ESG 등급을 나열하거나 확인하는 수준에 그쳐, 실제 주가 리스크와의 구체적인 연관성을 파악하기 힘듭니다.
- **해결하고자 한 방향**: ESG 등급 데이터를 정량화하고 실제 주가 변동성 파생지표와 결합하여, **"ESG 경영을 잘하는 기업이 주가 방어력도 좋은가?"** 라는 가설을 통계적으로 입증하고, 미래 리스크 추세를 예측하고자 했습니다.

## 5. 프로젝트 목표
- **기능적 목표**:
    - 5년치(2020~2024) ESG 데이터와 주가 데이터의 완벽한 매칭 및 통합 DB 구축.
    - ESG 등급과 주가 변동성 간의 유의미한 음(-)의 상관관계 규명.
- **기술적 목표**:
    - 동적 웹 페이지 크롤링(Selenium) 및 대용량 데이터 처리(Pandas) 능력 확보.
    - 통계적 가설 검정(Statsmodels) 및 시계열 예측 모델(ARIMA)의 실제 적용 능력 배양.
- **학습 목표**:
    - 데이터 수집부터 분석, 예측까지의 End-to-End 데이터 파이프라인 경험.
    - 금융 데이터의 특성(Seasonality, Trend) 이해 및 처리 방법 습득.

## 6. 프로젝트 구조
### 디렉토리 구조
```
project_ESG/
├── data_collection/        # 데이터 수집
│   └── ESG_crawling.py     # KRX ESG 포털 크롤링 스크립트
├── data_cleaning/          # 데이터 전처리
│   ├── ESG_cleaning_1.py   # 컬럼명 변경 및 1차 정제
│   ├── ESG_cleaning_2.py   # 연도별 병합 및 결측치/이상치 처리
│   ├── finance_cleaning_*.py # 주가 데이터와 ESG 데이터 결합
│   └── cleaned_data/       # 전처리 완료된 데이터 저장소
├── data_analysis/          # 분석 및 모델링
│   ├── finance_volatility.py # 주가 변동성 계산
│   ├── regression_analysis.py # OLS 회귀분석 및 산점도 시각화
│   └── time_series.py      # ARIMA 시계열 예측 모델링
└── requirements.txt        # 필요 라이브러리 목록 (예상)
```
### 데이터 흐름
1. **Web (KRX)** -> `data_collection` -> **Raw CSV**
2. **Raw CSV** -> `data_cleaning` -> **Merged Cleaning CSV**
3. **Merged CSV** -> `data_analysis` -> **Result (Report, Plot)**

## 7. 프로젝트 주요 기능 및 실행 흐름
### 1) 데이터 수집 (`data_collection/ESG_crawling.py`)
- Python Selenium을 사용하여 KRX ESG 포털에 접속.
- 연도별(2020~2024) 옵션을 선택하고 페이지네이션을 순회하며 전체 상장사의 ESG 등급을 스크래핑.
- 결과: `202X-ESG.csv` 파일 생성.

### 2) 데이터 정제 (`data_cleaning/`)
- **ESG 정제**: `ESG_cleaning_1.py`, `ESG_cleaning_2.py`를 통해 불필요한 컬럼 삭제, 연도 컬럼 추가, 5년 연속 데이터 존재 기업 필터링.
- **주가 데이터 병합**: `finance_cleaning_*.py`를 통해 외부 주가 데이터(CSV)와 ESG 데이터를 '종목명' 기준으로 Inner Join.

### 3) 통계 분석 및 예측 (`data_analysis/`)
- **변동성 계산**: `finance_volatility.py`에서 분기별 주가 수익률의 표준편차를 계산하여 '리스크' 지표로 변환.
- **회귀 분석**: `regression_analysis.py`에서 ESG 등급(독립변수)과 변동성(종속변수) 간의 선형 회귀 수행. -> *결과: ESG 등급이 높을수록 변동성이 낮아지는 경향 확인.*
- **시계열 예측**: `time_series.py`에서 상위 30%(ESG 우수)와 하위 30% 기업군의 변동성 추이를 ARIMA 모델로 학습하여 향후 3년치 예측 그래프 생성.

## 8. 설치 및 요구사항
### 실행 환경
- OS: Windows 10/11
- Language: Python 3.9+

### 필수 조건
- Google Chrome 브라우저 설치.
- 인터넷 연결 (크롤링 수행 시).

### 설치 방법
1. 프로젝트 클론 또는 다운로드
2. 의존성 라이브러리 설치:
   ```bash
   pip install pandas numpy selenium beautifulsoup4 statsmodels matplotlib
   ```

## 9. 기술 스택
- **Language**: Python
- **Data Collection**: Selenium, BeautifulSoup4
- **Data Processing**: Pandas, NumPy
- **Statistics & AI**: Statsmodels (OLS), ARIMA (sktime/statsmodels)
- **Visualization**: Matplotlib, Seaborn

## 10. 프로젝트 결과
- **구현 결과**: 
    - 전체 상장사 중 데이터가 유효한 기업 대상 ESG 등급 DB 구축 완료.
    - ESG 종합 등급 수치와 주가 변동성 간의 상관계수 도출.
- **시연 화면 예시**:
    - **회귀분석 결과**: OLS Regression Results 테이블 출력 (P-value < 0.05 확인).
    - **시각화**:  
      1. ESG 등급 vs 주가 변동성 산점도 및 추세선.
      2. 상위 30% 그룹 vs 하위 30% 그룹의 연도별 변동성 추이 비교 그래프.
      3. 향후 12분기 변동성 예측 그래프 (ARIMA).

## 11. 프로젝트를 통해 배운 점
- **기술적 성장**: 
    - 정적인 데이터뿐만 아니라 동적으로 로딩되는 웹 데이터를 수집하는 Selenium 활용 능력이 향상되었습니다.
    - 단순히 데이터를 시각화하는 것을 넘어, 통계적 모델(회귀분석)과 예측 모델(ARIMA)을 코드에 적용하며 데이터 사이언스 역량을 키웠습니다.
- **문제 해결 경험**: 
    - 서로 다른 소스(KRX, 금융포털)에서 가져온 데이터의 매칭률이 저조했던 문제를 해결하기 위해, 텍스트 전처리(공백 제거, 괄호 처리 등) 로직을 강화하여 매칭 성공률을 높였습니다.
- **한계 인식**: 
    - 주가 변동성에는 ESG 외에도 거시 경제 지표(금리, 환율 등)가 큰 영향을 미치는데, 이를 모두 통제 변수로 넣지 못한 점이 아쉽습니다. 향후 거시 변수를 추가하여 모델의 설명력을 높이고 싶습니다.

## 12. 요약
본 프로젝트는 **Python과 다양한 데이터 분석 라이브러리**를 활용하여, **ESG 경영이 기업의 주가 안정성에 긍정적인 영향을 미친다는 것을 데이터로 입증**한 사례입니다. 데이터 파이프라인 구축부터 통계적 검증, 미래 예측까지 데이터 분석의 전 과정을 수행하며 실질적인 인사이트를 도출해냈습니다.
